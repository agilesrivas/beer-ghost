if (self.CavalryLogger) { CavalryLogger.start_js(["h3Q1Z"]); }

__d("ReactComposerCollectionCreationDialog.react",["cx","fbt","ix","AsyncRequest","CurrentUser","DOM","DOMContainer.react","Image.react","immutable","PrivacyConst","PrivacySelector","ProfileFeaturedAlbumsToggle.react","ProfileSetsGatingConfig","React","SharedAlbumContributorsTokenizer.react","SimpleXUIDialog","TextAreaWithLineLimit.react","XCollectionCreateController","XCollectionCreationDialogController","XUIDialog.react","XUIDialogBody.react","XUIDialogButton.react","XUIDialogCancelButton.react","XUIDialogFooter.react","XUIDialogTitle.react","XUISpinner.react","XUITextInput.react","$"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l;k=babelHelpers.inherits(m,c("React").PureComponent);l=k&&k.prototype;function m(n){__p&&__p();l.constructor.call(this,n);this.$ReactComposerCollectionCreationDialog18=function(){this.setState({creatingAlbum:true});var o=c("XCollectionCreateController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(o).setMethod("POST").setData({title:this.$ReactComposerCollectionCreationDialog15(),contributors:this.state.contributors.map(function(p){return p.id}).toArray(),description:this.$ReactComposerCollectionCreationDialog16(),privacyx:this.$ReactComposerCollectionCreationDialog17(),should_feature:this.state.feature}).setHandler(function(p){this.setState({creatingAlbum:false});this.props.onAlbumCreated(p.payload.collectionThumbnailData)}.bind(this)).setErrorHandler(this.$ReactComposerCollectionCreationDialog19).send()}.bind(this);this.$ReactComposerCollectionCreationDialog19=function(o){this.setState({creatingAlbum:false});c("SimpleXUIDialog").show(i._("Tu \u00e1lbum no se ha podido crear ahora. Vuelve a intentarlo m\u00e1s tarde."),i._("Se ha producido un error..."))}.bind(this);this.$ReactComposerCollectionCreationDialog22=function(o){var p=this.state.contributors,q=p.add(o);this.setState({contributors:q})}.bind(this);this.$ReactComposerCollectionCreationDialog23=function(o){var p=this.state.contributors,q=p["delete"](o);this.setState({contributors:q})}.bind(this);this.$ReactComposerCollectionCreationDialog27=function(o){var p=this.$ReactComposerCollectionCreationDialog12();if(!p)return;this.setState({feature:o});if(o){p.selectOption(c("PrivacyConst").PostParam.EVERYONE.toString());p.disable()}else p.enable()}.bind(this);this.state={albumTitle:null,albumTitleHasBlurred:false,albumDescription:null,albumOwnerID:"",contributors:c("immutable").OrderedSet(),contributorSource:null,creatingAlbum:false,feature:false,privacySelectorLoaded:false}}m.prototype.componentWillMount=function(){m.$ReactComposerCollectionCreationDialog8[this.props.composerID]=this;this.$ReactComposerCollectionCreationDialog4=document.createElement("div");this.$ReactComposerCollectionCreationDialog4.setAttribute("id",this.$ReactComposerCollectionCreationDialog9());this.$ReactComposerCollectionCreationDialog5=document.createElement("div");this.$ReactComposerCollectionCreationDialog5.setAttribute("id",this.$ReactComposerCollectionCreationDialog10())};m.prototype.componentDidMount=function(){this.$ReactComposerCollectionCreationDialog3.layer.subscribe("hide",this.props.onCancel);var n=c("XCollectionCreationDialogController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(n).setMethod("GET").setReadOnly(true).setData({composer_id:this.props.composerID,privacy_placeholder_id:this.$ReactComposerCollectionCreationDialog9(),shared_album_privacy_placeholder_id:this.$ReactComposerCollectionCreationDialog10()}).setHandler(function(){return this.setState({privacySelectorLoaded:true})}.bind(this)).send()};m.prototype.componentDidUpdate=function(n,o){if(this.state.privacySelectorLoaded&&!o.privacySelectorLoaded)this.$ReactComposerCollectionCreationDialog2&&this.$ReactComposerCollectionCreationDialog2.focusInput()};m.prototype.componentWillUnmout=function(){m.$ReactComposerCollectionCreationDialog8[this.props.composerID]=null};m.prototype.componentWillUpdate=function(n,o){if(this.state.contributors.isEmpty()&&!o.contributors.isEmpty())this.$ReactComposerCollectionCreationDialog11(this.$ReactComposerCollectionCreationDialog12(),this.$ReactComposerCollectionCreationDialog13());else if(!this.state.contributors.isEmpty()&&o.contributors.isEmpty())this.$ReactComposerCollectionCreationDialog11(this.$ReactComposerCollectionCreationDialog13(),this.$ReactComposerCollectionCreationDialog12())};m.prototype.$ReactComposerCollectionCreationDialog12=function(){if(this.$ReactComposerCollectionCreationDialog6)return this.$ReactComposerCollectionCreationDialog6;else{this.$ReactComposerCollectionCreationDialog6=c("PrivacySelector").getAdamaSelectorInstance(c("$")(this.$ReactComposerCollectionCreationDialog9()));return this.$ReactComposerCollectionCreationDialog6}};m.prototype.$ReactComposerCollectionCreationDialog13=function(){if(this.$ReactComposerCollectionCreationDialog7)return this.$ReactComposerCollectionCreationDialog7;else{this.$ReactComposerCollectionCreationDialog7=c("PrivacySelector").getAdamaSelectorInstance(c("$")(this.$ReactComposerCollectionCreationDialog10()));return this.$ReactComposerCollectionCreationDialog7}};m.prototype.$ReactComposerCollectionCreationDialog11=function(n,o){if(!(n&&o))return;o.selectOption(n.getPostParam())};m.prototype.$ReactComposerCollectionCreationDialog9=function(){var n=this.props.composerID+".cph";return n.replace(/\./g,"-")};m.prototype.$ReactComposerCollectionCreationDialog10=function(){return this.$ReactComposerCollectionCreationDialog9()+"s"};m.prototype.$ReactComposerCollectionCreationDialog14=function(){var n=this.$ReactComposerCollectionCreationDialog15();if(!n||!n.match(/\S+/))return i._("Introduce un nombre para el \u00e1lbum").toString();else return null};m.prototype.$ReactComposerCollectionCreationDialog15=function(){return this.state.albumTitle};m.prototype.$ReactComposerCollectionCreationDialog16=function(){return this.state.albumDescription};m.prototype.$ReactComposerCollectionCreationDialog17=function(){var n=this.state.contributors.isEmpty()?this.$ReactComposerCollectionCreationDialog12():this.$ReactComposerCollectionCreationDialog13();if(n)return n.getPostParam();else{var o=this.state.contributors.isEmpty()?c("$")(this.$ReactComposerCollectionCreationDialog9()):c("$")(this.$ReactComposerCollectionCreationDialog10()),p=c("DOM").scry(o,'select option[selected="1"]').pop();return p&&p.value}};m.prototype.$ReactComposerCollectionCreationDialog20=function(){var n=c("React").createElement(c("Image.react"),{className:"_5-hz",src:j("85428")}),o=c("React").createElement("span",{className:"_5-h-"},i._("Crear"));return c("React").createElement(c("XUIDialogButton.react"),{action:"confirm",className:"_5-h_"+(this.state.creatingAlbum?" _5-i0":""),disabled:this.state.creatingAlbum||!this.state.privacySelectorLoaded||this.$ReactComposerCollectionCreationDialog14()!==null,image:n,label:o,onClick:this.$ReactComposerCollectionCreationDialog18,use:"confirm"})};m.prototype.$ReactComposerCollectionCreationDialog21=function(){return c("React").createElement(c("XUIDialogBody.react"),{className:"_5-i1 _5-i2"},c("React").createElement(c("XUISpinner.react"),{size:"large"}))};m.prototype.$ReactComposerCollectionCreationDialog24=function(){if(this.state.contributorSource==null)return c("React").createElement(c("XUISpinner.react"),{size:"small"});else return c("React").createElement(c("SharedAlbumContributorsTokenizer.react"),{className:"_5-i3",dataSource:this.state.contributorSource,disabled:this.state.feature,entries:this.state.contributors.toArray(),focusedOnInit:false,ownerID:this.state.albumOwnerID,onContributorAdded:this.$ReactComposerCollectionCreationDialog22,onContributorRemoved:this.$ReactComposerCollectionCreationDialog23,placeholder:c("CurrentUser").isWorkUser()?i._("Introduce los nombres de tus compa\u00f1eros de trabajo"):i._("Indica los nombres de tus amigos")})};m.prototype.$ReactComposerCollectionCreationDialog25=function(){return c("React").createElement("div",null,c("React").createElement("div",{className:!this.state.contributors.isEmpty()?"hidden_elem":""},c("React").createElement(c("DOMContainer.react"),null,this.$ReactComposerCollectionCreationDialog4)),c("React").createElement("div",{className:this.state.contributors.isEmpty()?"hidden_elem":""},c("React").createElement(c("DOMContainer.react"),null,this.$ReactComposerCollectionCreationDialog5)))};m.prototype.$ReactComposerCollectionCreationDialog26=function(){if(!c("ProfileSetsGatingConfig").can_see_featured_creation)return null;return c("React").createElement(c("ProfileFeaturedAlbumsToggle.react"),{checked:this.state.feature,disabled:!this.state.contributors.isEmpty(),onToggle:this.$ReactComposerCollectionCreationDialog27})};m.prototype.$ReactComposerCollectionCreationDialog28=function(){return c("React").createElement(c("XUIDialogBody.react"),{className:"_5-i1"},c("React").createElement("div",null,c("React").createElement(c("XUITextInput.react"),{onBlur:function(n){this.setState({albumTitleHasBlurred:true})}.bind(this),onChange:function(n){return this.setState({albumTitle:n.target.value})}.bind(this),placeholder:i._("Nombre del \u00e1lbum"),ref:function(n){return this.$ReactComposerCollectionCreationDialog2=n}.bind(this),required:true,value:this.state.albumTitle,xuiError:this.state.albumTitleHasBlurred&&this.$ReactComposerCollectionCreationDialog14()})),c("React").createElement("div",null,c("React").createElement(c("TextAreaWithLineLimit.react"),{onChange:function(n){return this.setState({albumDescription:n})}.bind(this),placeholder:i._("A\u00f1ade una descripci\u00f3n"),ref:function(n){return this.$ReactComposerCollectionCreationDialog1=n}.bind(this),value:this.state.albumDescription})),c("CurrentUser").isWorkUser()?null:c("React").createElement("div",{className:"_5-i4"},c("React").createElement("label",null,i._("A\u00f1adir colaboradores"),this.$ReactComposerCollectionCreationDialog24())),this.$ReactComposerCollectionCreationDialog26(),c("React").createElement("div",{className:"_5-i4"},c("React").createElement("label",null,i._("Privacidad"),this.$ReactComposerCollectionCreationDialog25())))};m.initContributorsField=function(n,o,p){var q=m.$ReactComposerCollectionCreationDialog8[n];q.setState({albumOwnerID:p,contributorSource:o})};m.prototype.render=function(){return c("React").createElement(c("XUIDialog.react"),babelHelpers["extends"]({className:"_5-i5",ref:function(n){return this.$ReactComposerCollectionCreationDialog3=n}.bind(this)},this.props.dialogProps),c("React").createElement(c("XUIDialogTitle.react"),null,i._("Crear \u00e1lbum")),this.state.privacySelectorLoaded?this.$ReactComposerCollectionCreationDialog28():this.$ReactComposerCollectionCreationDialog21(),c("React").createElement(c("XUIDialogFooter.react"),{className:"_5-i6"},c("React").createElement(c("XUIDialogCancelButton.react"),null),this.$ReactComposerCollectionCreationDialog20()))};m.$ReactComposerCollectionCreationDialog8={};f.exports=m}),null);